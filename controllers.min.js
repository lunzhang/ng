app.controller("babylonController",function(t){var e=document.getElementById("renderCanvas"),n=new BABYLON.Engine(e,!0),i=function(){var t=new BABYLON.Scene(n),i=new BABYLON.FreeCamera("camera1",new BABYLON.Vector3(0,5,-10),t);i.setTarget(BABYLON.Vector3.Zero()),i.attachControl(e,!1);var o=(new BABYLON.HemisphericLight("light1",new BABYLON.Vector3(0,1,0),t),BABYLON.Mesh.CreateSphere("sphere1",16,2,t));return o.material=new BABYLON.StandardMaterial("texture1",t),o.material.wireframe=!0,t},o=i();n.runRenderLoop(function(){o.render()}),window.addEventListener("resize",function(){n.resize()})}),app.controller("blogController",function(t,e,n,i){t.scrollTo=function(t){n.hash(t),i()}}),app.controller("d3Controller",function(t){!function(){function t(t,r,l,s){if(t)throw t;var c=topojson.feature(r,r.objects.countries).features;c=c.filter(function(t){return l.some(function(e){return t.id==e.id?t.name=e.name:void 0})}).sort(function(t,e){return t.name.localeCompare(e.name)}),a.selectAll("path.land").data(c).enter().append("path").attr("class","land").attr("d",o).attr("name",function(t,e){return name=t.name}).attr("i",function(t,e){return e=e}),a.insert("path").datum(topojson.mesh(r,r.objects.countries,function(t,e){return t!==e})).attr("class","boundary").attr("d",o);var d,u=!1;a.selectAll("circle").data(s).enter().append("circle").attr("cx",function(t){return i([t.lon,t.lat])[0]}).attr("cy",function(t){return i([t.lon,t.lat])[1]}).attr("r",1).attr("id",function(t){return t.location}).style("fill","#E43131").style("display","none"),this.zoomIn=function(t,i){var r=o.bounds(c[t]),l=r[1][0]-r[0][0],s=r[1][1]-r[0][1],p=(r[0][0]+r[1][0])/2,f=(r[0][1]+r[1][1])/2,m=.9/Math.max(l/e,s/n),h=[e/2-m*p,n/2-m*f];a.transition().duration(750).attr("transform","translate("+h+")scale("+m+")").each("end",function(){a.attr("zoom",!0),d=c[t].name,u=!1,a.select("#"+i).style("display","inline")})},this.transition=function(t,e){d3.transition().duration(1e3).tween("rotate",function(){var e=d3.geo.centroid(c[t]),n=d3.interpolate(i.rotate(),[-e[0],-e[1]]);return function(t){i.rotate(n(t)),a.selectAll("path").attr("d",o).classed("focused",function(t,e){}),a.selectAll("circle").attr("cx",function(t){return i([t.lon,t.lat])[0]}).attr("cy",function(t){return i([t.lon,t.lat])[1]})}}).transition().each("end",function(){zoomIn(t,e)})},this.zoomOut=function(t,e){u||("true"===a.attr("zoom")&&d!=c[t].name?(u=!0,a.transition().duration(750).attr("transform","translate(0,0) scale(1,1)").each("end",function(){a.select("circle").style("display","none"),transition(t,e)})):"false"===a.attr("zoom")?(u=!0,a.select("circle").style("display","none"),transition(t,e)):(a.select("circle").style("display","none"),a.select("#"+e).style("display","inline")))}}var e=360,n=360,i=d3.geo.orthographic().scale(180).translate([e/2,n/2]).clipAngle(90).precision(.1),o=d3.geo.path().projection(i),r=(d3.geo.graticule(),d3.select("#globe").append("svg").attr("width",e).attr("height",n)),a=r.append("g").attr("zoom",!1);a.append("defs").append("path").datum({type:"Sphere"}).attr("id","sphere").attr("d",o),a.append("use").attr("class","fill").attr("xlink:href","#sphere"),queue().defer(d3.json,"/lib/d3/world-110m.json").defer(d3.tsv,"/lib/d3/world-country-names.tsv").defer(d3.csv,"/lib/d3/locations.csv").await(t)}(),function(){var e=[{times:[{starting_time:757287682200,display:"circle",id:"born",index:31,location:"wz",tip:"Born in Wz,CN on 11/30/1993"}]},{times:[{starting_time:969655282200,display:"circle",id:"us",index:164,location:"nyc",tip:"Arrived in Nyc,US on 8/22/2000"}]},{times:[{starting_time:1224016882200,display:"circle",id:"hs",index:164,location:"nyc",tip:"Started Bronx Science HS on 9/14/2008"}]},{times:[{starting_time:1348260082200,display:"circle",id:"college",index:164,location:"sb",tip:"Started Stony Brook on 8/21/2012"}]},{times:[{starting_time:1435178482200,display:"circle",id:"bluum",index:164,location:"nyc",tip:"Intern at Bluum on 5/24/2015 to 8/12/2015"}]},{times:[{starting_time:1453585282200,display:"circle",id:"grad",index:164,location:"sb",tip:"Graduated Stony Brook on 12/23/2015"}]},{times:[{starting_time:1458679282200,display:"circle",id:"fxcm",index:164,location:"nyc",tip:"Started Fxcm on 2/22/2016"}]}],n=d3.select("#tooltip"),i=d3.timeline().tickFormat({format:d3.time.format("%Y"),tickTime:d3.time.years,tickInterval:1,tickSize:3}).width("1000").beginning(757287682200).ending(1458679282200).mouseover(function(e,i,o){var r="#"+e.id,a=$(r).offset().left-100,l=$(r).offset().top-80;t.tip=e.tip,t.$apply(),n.style("left",a+"px").style("top",l+"px").style("display","block"),zoomOut(e.index,e.location)}).mouseout(function(t,e,i){n.style("display","none")}),o=d3.select("#timeline").append("svg").attr("width","1000").datum(e).call(i);o.selectAll("circle").attr("r",7),o.selectAll("text").attr("font-size",15)}()}),app.controller("flappypigController",function(t,e,n){new FlappyPig.Game}),app.controller("infoController",function(t,e,n){!function(){function n(t){for(var e=0;e<t.length;e++){var n=(new Date).getTime(),i=t[e],o=(i.timestamp||n)-n,r=a-i.size,s=l-i.size;i.timestamp=n,i.x+=o*i.velX,i.y+=o*i.velY,i.x>r?(i.x=r,i.velX*=-1):i.x<0&&(i.x=0,i.velX*=-1),i.y>s?(i.y=s,i.velY*=-1):i.y<0&&(i.y=0,i.velY*=-1)}}function i(t){for(var e=0;e<t.length;e++){var n=t[e];n.detectCollision(t)}}function o(e){for(var n=0;e>n;n++)t.bubbles.push(r(n))}function r(t){var e=.1,n=22,i=a-n,o=l-n;return{id:t,size:n,color:"white",x:Math.random()*i,y:Math.random()*o,maxVelocity:e,velX:Math.random()*e*(Math.random()<.5?-1:1),velY:Math.random()*e*(Math.random()<.5?-1:1),detectCollision:function(t){for(var e=0;e<t.length;e++){var n=t[e];if(n!=this){var i=n.x-this.x,o=n.y-this.y,r=Math.sqrt(i*i+o*o),a=n.size/2+this.size/2;if(a>r){for(;a>r;)n.x+=n.velX,n.y+=n.velY,this.x+=this.velX,this.y+=this.velY,i=n.x-this.x,o=n.y-this.y,r=Math.sqrt(i*i+o*o);this.velX*=-1,this.velY*=-1,n.velX*=-1,n.velY*=-1}}}}}}var a=jQuery(document).outerWidth(),l=jQuery(document).outerHeight(),s=a*l;if(75e4>s)var c=10;else var c=22;var d;t.$watch(function(){return jQuery(document).outerHeight()},function(e){l=e,t.bubbles=[],o(c)}),t.$watch(function(){return jQuery(document).outerWidth()},function(e){a=e,t.bubbles=[],o(c)}),t.bubbles=[],o(c),d=e(function(){n(t.bubbles),i(t.bubbles)},30)}(),function(){function e(e,n,l,c){if(e)throw e;var d=topojson.feature(n,n.objects.countries).features;d=d.filter(function(t){return l.some(function(e){return t.id==e.id?t.name=e.name:void 0})}).sort(function(t,e){return t.name.localeCompare(e.name)}),s.selectAll("path.land").data(d).enter().append("path").attr("class","land").attr("d",a).attr("name",function(t,e){return name=t.name}).attr("i",function(t,e){return e=e}),s.insert("path").datum(topojson.mesh(n,n.objects.countries,function(t,e){return t!==e})).attr("class","boundary").attr("d",a);var u,p=!1;s.selectAll("circle").data(c).enter().append("circle").attr("cx",function(t){return r([t.lon,t.lat])[0]}).attr("cy",function(t){return r([t.lon,t.lat])[1]}).attr("id",function(t){return t.location}).style("fill","#E43131").style("display","none");var f=d3.select("#tooltip");this.zoomIn=function(t,e){var n=a.bounds(d[t]),r=n[1][0]-n[0][0],l=n[1][1]-n[0][1],c=(n[0][0]+n[1][0])/2,m=(n[0][1]+n[1][1])/2,h=.9/Math.max(r/i,l/o),y=[i/2-h*c,o/2-h*m];s.transition().duration(750).attr("transform","translate("+y+")scale("+h+")").each("end",function(){s.attr("zoom",!0),u=d[t].name,p=!1;var n="#"+e;s.select(n).style("display","inline");var i=$(n).offset().left-100,o=$(n).offset().top-100;f.style("left",i+"px").style("top",o+"px").style("display","block")})},this.transition=function(t,e){d3.transition().duration(1e3).tween("rotate",function(){var e=d3.geo.centroid(d[t]),n=d3.interpolate(r.rotate(),[-e[0],-e[1]]);return function(t){r.rotate(n(t)),s.selectAll("path").attr("d",a).classed("focused",function(t,e){}),s.selectAll("circle").attr("cx",function(t){return r([t.lon,t.lat])[0]}).attr("cy",function(t){return r([t.lon,t.lat])[1]})}}).transition().each("end",function(){zoomIn(t,e)})},this.zoomOut=function(e,n,i){t.tip=i,t.$apply(),p||("true"===s.attr("zoom")&&u!=d[e].name?(f.style("display","none"),p=!0,s.transition().duration(750).attr("transform","translate(0,0) scale(1,1)").each("end",function(){s.selectAll("circle").style("display","none"),transition(e,n)})):"false"===s.attr("zoom")?(p=!0,s.selectAll("circle").style("display","none"),transition(e,n)):(s.selectAll("circle").style("display","none"),s.select("#"+n).style("display","inline")))}}var n=$(window).width();if(400>n)var i=180,o=180,r=d3.geo.orthographic().scale(90).translate([i/2,o/2]).clipAngle(90).precision(.1);else var i=360,o=360,r=d3.geo.orthographic().scale(180).translate([i/2,o/2]).clipAngle(90).precision(.1);var a=d3.geo.path().projection(r),l=(d3.geo.graticule(),d3.select("#globe").append("svg").attr("width",i).attr("height",o)),s=l.append("g").attr("zoom",!1);s.append("defs").append("path").datum({type:"Sphere"}).attr("id","sphere").attr("d",a),s.append("use").attr("class","fill").attr("xlink:href","#sphere"),queue().defer(d3.json,"/lib/d3/world-110m.json").defer(d3.tsv,"/lib/d3/world-country-names.tsv").defer(d3.csv,"/lib/d3/locations.csv").await(e)}(),function(){var t=[{times:[{starting_time:757287682200,display:"circle",id:"born",index:31,location:"wz",tip:"Born in Wz,CN on 11/30/1993"}]},{times:[{starting_time:969655282200,display:"circle",id:"us",index:164,location:"nyc",tip:"Arrived in Nyc,US on 8/22/2000"}]},{times:[{starting_time:1224016882200,display:"circle",id:"hs",index:164,location:"nyc",tip:"Started Bronx Science HS on 9/14/2008"}]},{times:[{starting_time:1348260082200,display:"circle",id:"college",index:164,location:"sb",tip:"Started Stony Brook on 8/21/2012"}]},{times:[{starting_time:1435178482200,display:"circle",id:"bluum",index:164,location:"nyc",tip:"Intern at Bluum on 5/24/2015 to 8/12/2015"}]},{times:[{starting_time:1453585282200,display:"circle",id:"grad",index:164,location:"sb",tip:"Graduated Stony Brook on 12/23/2015"}]},{times:[{starting_time:1458679282200,display:"circle",id:"fxcm",index:164,location:"nyc",tip:"Started Fxcm on 2/22/2016"}]}],e=(d3.select("#tooltip"),d3.timeline().tickFormat({format:d3.time.format("%Y"),tickTime:d3.time.years,tickInterval:1,tickSize:3}).width("1000").beginning(757287682200).ending(1458679282200).mouseover(function(t,e,n){zoomOut(t.index,t.location,t.tip)}).mouseout(function(t,e,n){}));d3.select("#timeline").append("svg").attr("width","1000").datum(t).call(e)}()}),app.controller("nikeController",function(t,e,n){function i(n){$.ajax({url:n,dataType:"JSONP",jsonpCallback:"callback",type:"GET",success:function(n){if(n.nextPageDataService&&10>c)s=n.nextPageDataService,a=a.concat(n.sections[0].products),i(s),c++;else{for(var d=0;d<a.length;d++){var u=a[d];u.newPrice=parseInt(u.localPrice.replace("$","")),u.oldPrice=parseInt(u.overriddenLocalPrice.replace("$",""));for(var p=!1,f=0;f<o.length;f++){var m=o[f];u.title==m.title&&(p=!0)}p||l.push(u)}l.length>0?(e.localStorage.setItem("prevNewShoes",JSON.stringify(l)),e.localStorage.setItem("oldShoes",JSON.stringify(a))):l=r,t.oldShoes=o,t.newShoes=l,t.currentShoes=a,t.showCurrent=!0,t.showNew=!1,t.$apply()}}})}var o=e.localStorage.getItem("oldShoes"),r=e.localStorage.getItem("prevNewShoes"),a=[],l=[],s="http://store.nike.com/html-services/gridwallData?country=US&lang_locale=en_US&gridwallPath=mens-clearance-shoes/47Z7puZoi3&sortOrder=publishdate|desc",c=0;o=o?JSON.parse(o):[],r=r?JSON.parse(r):[],i(s),t.toggleShoes=function(){t.showCurrent?(t.showCurrent=!1,t.showNew=!0):(t.showNew=!1,t.showCurrent=!0)}}),app.controller("socketController",function(t,e){var n=io.connect("www.live-lunny93.rhcloud.com:8000"),i=$("#input-box");$("#message-box");t.messages=[],i.on("keydown",function(t){return 13!=t.keyCode||t.shiftKey?void 0:(n.emit("message",i.val()),i.val(""),!1)}),n.on("message",function(e){t.messages.push(e),t.$apply()})}),app.controller("loginController",["$scope","$state","authentication",function(t,e,n){t.credentials={email:"",password:""},t.onSubmit=function(){n.login(t.credentials).error(function(t){alert(t)}).then(function(){e.go("profile")})}}]),app.controller("registerController",["$scope","$state","authentication",function(t,e,n){t.credentials={email:"",password:""},t.onSubmit=function(){n.register(t.credentials).error(function(t){alert(t)}).then(function(t){e.go("profile")})}}]),app.controller("profileController",["$scope","authentication",function(t,e){e.getProfile().success(function(e){t.user=e}).error(function(t){console.log(t)})}]),app.service("authentication",["$http","$window","user",function(t,e,n){this.saveToken=function(t){n.token=t},this.getToken=function(){return n.token},this.isLoggedIn=function(){var t,n=this.getToken();return n?(t=n.split(".")[1],t=e.atob(t),t=JSON.parse(t),t.exp>Date.now()/1e3):!1},this.currentUser=function(){if(isLoggedIn()){var t=getToken(),n=t.split(".")[1];return n=e.atob(n),n=JSON.parse(n),{email:n.email,name:n.name}}},this.register=function(e){var n=this;return t.post("/api/register",e).success(function(t){n.saveToken(t.token)})},this.login=function(e){var n=this;return t.post("/api/login",e).success(function(t){n.saveToken(t.token)})},this.logout=function(){n.token=void 0},this.getProfile=function(){var e=this;return t.get("/api/profile",{headers:{Authorization:"Bearer "+e.getToken()}})}}]),app.service("user",["$http",function(t){this.token,this.email,this.password}]);