app.controller("babylonController",["$scope",function(t){var e=document.getElementById("renderCanvas"),n=new BABYLON.Engine(e,!0),o=function(){var t=new BABYLON.Scene(n),o=new BABYLON.FreeCamera("camera1",new BABYLON.Vector3(0,5,-10),t);o.setTarget(BABYLON.Vector3.Zero()),o.attachControl(e,!1);var r=(new BABYLON.HemisphericLight("light1",new BABYLON.Vector3(0,1,0),t),BABYLON.Mesh.CreateSphere("sphere1",16,2,t));return r.material=new BABYLON.StandardMaterial("texture1",t),r.material.wireframe=!0,t},r=o();n.runRenderLoop(function(){r.render()}),window.addEventListener("resize",function(){n.resize()})}]),app.controller("blogController",["$scope","$location","$anchorScroll",function(t,e,n){t.scrollTo=function(t){e.hash(t),n()}}]),app.controller("d3Controller",["$scope","$http",function(t,e){function n(t,e){var n=d3.svg.line().x(function(t){return u(t.date)}).y(function(t){return d(t[e])});return n(t)}function o(t,e){var n=d3.svg.line().x(function(t){return u(t.date)}).y(function(t){return d(t[a[e]])});return n(t)}function r(t){f.selectAll(".line").remove(),e.get("/api/rates/"+t).then(function(t){i=t.data.rates,i.forEach(function(t){t.date=1e3*t.date}),u.domain(d3.extent(i,function(t){return t.date})),d.domain([d3.min(i,function(t){return Math.min(t.bidOpen,t.bidClose,t.bidHigh,t.bidLow,t.askOpen,t.askClose,t.askHigh,t.askLow)}),d3.max(i,function(t){return Math.max(t.bidOpen,t.bidClose,t.bidHigh,t.bidLow,t.askOpen,t.askClose,t.askHigh,t.askLow)})]),f.select(".x.axis").call(p),f.select(".y.axis").call(h);for(var e=0;e<a.length;e++)f.append("path").attr("class","line").attr("id",a[e]).attr("d",o(i,e))})}var i,a=["bidOpen"],s={top:20,right:20,bottom:30,left:50},l=500-s.left-s.right,c=960-s.top-s.bottom,u=d3.time.scale().range([0,c]),d=d3.scale.linear().range([l,0]),p=d3.svg.axis().scale(u).orient("bottom"),h=d3.svg.axis().scale(d).orient("left"),f=d3.select("#chart").append("svg").attr("width",c+s.left+s.right).attr("height",l+s.top+s.bottom).append("g").attr("transform","translate("+s.left+","+s.top+")");f.append("g").attr("class","x axis").attr("transform","translate(0,"+l+")"),f.append("g").attr("class","y axis"),$("#period :radio").change(function(t){var e=$(this).val();r(e)}),$("#rates :checkbox").change(function(t){var e=$(this),o=e.val();e.is(":checked")?(a.push(o),f.append("path").attr("class","line").attr("id",o).attr("d",n(i,o))):(a.splice(a.indexOf(o),1),f.select("#"+o).remove())}),r("M1")}]),app.controller("flappypigController",["$scope","$window","$document",function(t,e,n){new FlappyPig.Game}]),app.controller("infoController",["$scope","$interval",function(t,e){!function(){function n(t){for(var e=0;e<t.length;e++){var n=(new Date).getTime(),o=t[e],r=(o.timestamp||n)-n,i=a-o.size,l=s-o.size;o.timestamp=n,o.x+=r*o.velX,o.y+=r*o.velY,o.x>i?(o.x=i,o.velX*=-1):o.x<0&&(o.x=0,o.velX*=-1),o.y>l?(o.y=l,o.velY*=-1):o.y<0&&(o.y=0,o.velY*=-1)}}function o(t){for(var e=0;e<t.length;e++){var n=t[e];n.detectCollision(t)}}function r(e){for(var n=0;e>n;n++)t.bubbles.push(i(n))}function i(t){var e=.1,n=22,o=a-n,r=s-n;return{id:t,size:n,color:"white",x:Math.random()*o,y:Math.random()*r,maxVelocity:e,velX:Math.random()*e*(Math.random()<.5?-1:1),velY:Math.random()*e*(Math.random()<.5?-1:1),detectCollision:function(t){for(var e=0;e<t.length;e++){var n=t[e];if(n!=this){var o=n.x-this.x,r=n.y-this.y,i=Math.sqrt(o*o+r*r),a=n.size/2+this.size/2;if(a>i){for(;a>i;)n.x+=n.velX,n.y+=n.velY,this.x+=this.velX,this.y+=this.velY,o=n.x-this.x,r=n.y-this.y,i=Math.sqrt(o*o+r*r);this.velX*=-1,this.velY*=-1,n.velX*=-1,n.velY*=-1}}}}}}var a=jQuery(document).outerWidth(),s=jQuery(document).outerHeight(),l=a*s;if(75e4>l)var c=10;else var c=22;var u;t.$watch(function(){return jQuery(document).outerHeight()},function(e){s=e,t.bubbles=[],r(c)}),t.$watch(function(){return jQuery(document).outerWidth()},function(e){a=e,t.bubbles=[],r(c)}),t.bubbles=[],r(c),u=e(function(){n(t.bubbles),o(t.bubbles)},30)}(),function(){function e(e,n,s,c){if(e)throw e;var u=topojson.feature(n,n.objects.countries).features;u=u.filter(function(t){return s.some(function(e){return t.id==e.id?t.name=e.name:void 0})}).sort(function(t,e){return t.name.localeCompare(e.name)}),l.selectAll("path.land").data(u).enter().append("path").attr("class","land").attr("d",a).attr("name",function(t,e){return name=t.name}).attr("i",function(t,e){return e=e}),l.insert("path").datum(topojson.mesh(n,n.objects.countries,function(t,e){return t!==e})).attr("class","boundary").attr("d",a);var d,p=!1;l.selectAll("circle").data(c).enter().append("circle").attr("cx",function(t){return i([t.lon,t.lat])[0]}).attr("cy",function(t){return i([t.lon,t.lat])[1]}).attr("id",function(t){return t.location}).style("fill","#E43131").style("display","none");var h=d3.select("#tooltip");this.zoomIn=function(t,e){var n=a.bounds(u[t]),i=n[1][0]-n[0][0],s=n[1][1]-n[0][1],c=(n[0][0]+n[1][0])/2,f=(n[0][1]+n[1][1])/2,m=.9/Math.max(i/o,s/r),g=[o/2-m*c,r/2-m*f];l.transition().duration(750).attr("transform","translate("+g+")scale("+m+")").each("end",function(){l.attr("zoom",!0),d=u[t].name,p=!1;var n="#"+e;l.select(n).style("display","inline");var o=$(n).offset().left-100,r=$(n).offset().top-100;h.style("left",o+"px").style("top",r+"px").style("display","block")})},this.transition=function(t,e){d3.transition().duration(1e3).tween("rotate",function(){var e=d3.geo.centroid(u[t]),n=d3.interpolate(i.rotate(),[-e[0],-e[1]]);return function(t){i.rotate(n(t)),l.selectAll("path").attr("d",a).classed("focused",function(t,e){}),l.selectAll("circle").attr("cx",function(t){return i([t.lon,t.lat])[0]}).attr("cy",function(t){return i([t.lon,t.lat])[1]})}}).transition().each("end",function(){zoomIn(t,e)})},this.zoomOut=function(e,n,o){t.tip=o,t.$apply(),p||("true"===l.attr("zoom")&&d!=u[e].name?(h.style("display","none"),p=!0,l.transition().duration(750).attr("transform","translate(0,0) scale(1,1)").each("end",function(){l.selectAll("circle").style("display","none"),transition(e,n)})):"false"===l.attr("zoom")?(p=!0,l.selectAll("circle").style("display","none"),transition(e,n)):(l.selectAll("circle").style("display","none"),l.select("#"+n).style("display","inline")))}}var n=$(window).width();if(400>n)var o=180,r=180,i=d3.geo.orthographic().scale(90).translate([o/2,r/2]).clipAngle(90).precision(.1);else var o=360,r=360,i=d3.geo.orthographic().scale(180).translate([o/2,r/2]).clipAngle(90).precision(.1);var a=d3.geo.path().projection(i),s=(d3.geo.graticule(),d3.select("#globe").append("svg").attr("width",o).attr("height",r)),l=s.append("g").attr("zoom",!1);l.append("defs").append("path").datum({type:"Sphere"}).attr("id","sphere").attr("d",a),l.append("use").attr("class","fill").attr("xlink:href","#sphere"),queue().defer(d3.json,"/lib/d3/world-110m.json").defer(d3.tsv,"/lib/d3/world-country-names.tsv").defer(d3.csv,"/lib/d3/locations.csv").await(e)}(),function(){var t=[{times:[{starting_time:757287682200,display:"circle",id:"born",index:31,location:"wz",tip:"Born in Wz,CN on 11/30/1993"}]},{times:[{starting_time:969655282200,display:"circle",id:"us",index:164,location:"nyc",tip:"Arrived in Nyc,US on 8/22/2000"}]},{times:[{starting_time:1224016882200,display:"circle",id:"hs",index:164,location:"nyc",tip:"Started Bronx Science HS on 9/14/2008"}]},{times:[{starting_time:1348260082200,display:"circle",id:"college",index:164,location:"sb",tip:"Started Stony Brook on 8/21/2012"}]},{times:[{starting_time:1435178482200,display:"circle",id:"bluum",index:164,location:"nyc",tip:"Intern at Bluum on 5/24/2015 to 8/12/2015"}]},{times:[{starting_time:1453585282200,display:"circle",id:"grad",index:164,location:"sb",tip:"Graduated Stony Brook on 12/23/2015"}]},{times:[{starting_time:1458679282200,display:"circle",id:"fxcm",index:164,location:"nyc",tip:"Started Fxcm on 2/22/2016"}]}],e=(d3.select("#tooltip"),d3.timeline().tickFormat({format:d3.time.format("%Y"),tickTime:d3.time.years,tickInterval:1,tickSize:3}).width("1000").beginning(757287682200).ending(1458679282200).mouseover(function(t,e,n){zoomOut(t.index,t.location,t.tip)}).mouseout(function(t,e,n){}));d3.select("#timeline").append("svg").attr("width","1000").datum(t).call(e)}()}]),app.controller("nikeController",["$scope","$window","$http",function(t,e,n){function o(n){$.ajax({url:n,dataType:"JSONP",jsonpCallback:"callback",type:"GET",success:function(n){if(n.nextPageDataService&&10>c)l=n.nextPageDataService,a=a.concat(n.sections[0].products),o(l),c++;else{for(var u=0;u<a.length;u++){var d=a[u];d.newPrice=parseInt(d.localPrice.replace("$","")),d.oldPrice=parseInt(d.overriddenLocalPrice.replace("$",""));for(var p=!1,h=0;h<r.length;h++){var f=r[h];d.title==f.title&&(p=!0)}p||s.push(d)}s.length>0?(e.localStorage.setItem("prevNewShoes",JSON.stringify(s)),e.localStorage.setItem("oldShoes",JSON.stringify(a))):s=i,t.oldShoes=r,t.newShoes=s,t.currentShoes=a,t.showCurrent=!0,t.showNew=!1,t.$apply()}}})}var r=e.localStorage.getItem("oldShoes"),i=e.localStorage.getItem("prevNewShoes"),a=[],s=[],l="http://store.nike.com/html-services/gridwallData?country=US&lang_locale=en_US&gridwallPath=mens-clearance-shoes/47Z7puZoi3&sortOrder=publishdate|desc",c=0;r=r?JSON.parse(r):[],i=i?JSON.parse(i):[],o(l),t.toggleShoes=function(){t.showCurrent?(t.showCurrent=!1,t.showNew=!0):(t.showNew=!1,t.showCurrent=!0)}}]),app.controller("socketController",["$scope","$timeout","$http",function(t,e,n){n.get("/api/messages").then(function(e){t.messages=e.data.messages});var o=io.connect("localhost:3000"),r=$("#input-box");$("#message-box");r.on("keydown",function(t){return 13!=t.keyCode||t.shiftKey?void 0:(o.emit("message",r.val()),r.val(""),!1)}),o.on("message",function(e){t.messages.push(e),t.$apply()})}]),app.controller("loginController",["$scope","$state","authentication",function(t,e,n){t.credentials={email:"",password:""},t.onSubmit=function(){n.login(t.credentials).error(function(t){console.log(t)}).then(function(){e.go("profile")})}}]),app.controller("profileController",["$scope","authentication",function(t,e){e.getProfile().success(function(e){t.user=e}).error(function(t){console.log(err)})}]),app.controller("registerController",["$scope","$state","authentication",function(t,e,n){t.credentials={email:"",password:""},t.onSubmit=function(){n.register(t.credentials).error(function(t){console.log(t)}).then(function(t){e.go("profile")})}}]),app.service("authentication",["$http","$window","user",function(t,e,n){this.saveToken=function(t){n.token=t},this.getToken=function(){return n.token},this.isLoggedIn=function(){var t,n=this.getToken();return n?(t=n.split(".")[1],t=e.atob(t),t=JSON.parse(t),t.exp>Date.now()/1e3):!1},this.currentUser=function(){if(isLoggedIn()){var t=getToken(),n=t.split(".")[1];return n=e.atob(n),n=JSON.parse(n),{email:n.email,name:n.name}}},this.register=function(e){var n=this;return t.post("/api/register",e).success(function(t){n.saveToken(t.token)})},this.login=function(e){var n=this;return t.post("/api/login",e).success(function(t){n.saveToken(t.token)})},this.logout=function(){n.token=void 0},this.getProfile=function(){var e=this;return t.get("/api/profile",{headers:{Authorization:"Bearer "+e.getToken()}})}}]),app.service("user",["$http",function(t){this.token,this.email,this.password}]);