app.controller("babylonController",["$scope",function(t){var e=document.getElementById("renderCanvas"),n=new BABYLON.Engine(e,!0),o=function(){var t=new BABYLON.Scene(n),o=new BABYLON.FreeCamera("camera1",new BABYLON.Vector3(0,5,-10),t);o.setTarget(BABYLON.Vector3.Zero()),o.attachControl(e,!1);var i=(new BABYLON.HemisphericLight("light1",new BABYLON.Vector3(0,1,0),t),BABYLON.Mesh.CreateSphere("sphere1",16,2,t));return i.material=new BABYLON.StandardMaterial("texture1",t),i.material.wireframe=!0,t},i=o();n.runRenderLoop(function(){i.render()}),window.addEventListener("resize",function(){n.resize()})}]),app.controller("d3Controller",["$scope","$http",function(t,e){!function(){function e(e,n,l,c){if(e)throw e;var d=topojson.feature(n,n.objects.countries).features;d=d.filter(function(t){return l.some(function(e){return t.id==e.id?t.name=e.name:void 0})}).sort(function(t,e){return t.name.localeCompare(e.name)}),s.selectAll("path.land").data(d).enter().append("path").attr("class","land").attr("d",r).attr("name",function(t,e){return name=t.name}).attr("i",function(t,e){return e=e}),s.insert("path").datum(topojson.mesh(n,n.objects.countries,function(t,e){return t!==e})).attr("class","boundary").attr("d",r);var u,p=!1;s.selectAll("circle").data(c).enter().append("circle").attr("cx",function(t){return a([t.lon,t.lat])[0]}).attr("cy",function(t){return a([t.lon,t.lat])[1]}).attr("id",function(t){return t.location}).style("fill","#E43131").style("display","none");var m=d3.select("#tooltip");this.zoomIn=function(t,e){var n=r.bounds(d[t]),a=n[1][0]-n[0][0],l=n[1][1]-n[0][1],c=(n[0][0]+n[1][0])/2,f=(n[0][1]+n[1][1])/2,g=.9/Math.max(a/o,l/i),h=[o/2-g*c,i/2-g*f];s.transition().duration(750).attr("transform","translate("+h+")scale("+g+")").each("end",function(){s.attr("zoom",!0),u=d[t].name,p=!1;var n="#"+e;s.select(n).style("display","inline");var o=$(n).offset().left-100,i=$(n).offset().top-100;m.style("left",o+"px").style("top",i+"px").style("display","block")})},this.transition=function(t,e){d3.transition().duration(1e3).tween("rotate",function(){var e=d3.geo.centroid(d[t]),n=d3.interpolate(a.rotate(),[-e[0],-e[1]]);return function(t){a.rotate(n(t)),s.selectAll("path").attr("d",r).classed("focused",function(t,e){}),s.selectAll("circle").attr("cx",function(t){return a([t.lon,t.lat])[0]}).attr("cy",function(t){return a([t.lon,t.lat])[1]})}}).transition().each("end",function(){zoomIn(t,e)})},this.zoomOut=function(e,n,o){t.tip=o,t.$apply(),p||("true"===s.attr("zoom")&&u!=d[e].name?(m.style("display","none"),p=!0,s.transition().duration(750).attr("transform","translate(0,0) scale(1,1)").each("end",function(){s.selectAll("circle").style("display","none"),transition(e,n)})):"false"===s.attr("zoom")?(p=!0,s.selectAll("circle").style("display","none"),transition(e,n)):(s.selectAll("circle").style("display","none"),s.select("#"+n).style("display","inline")))}}var n=$(window).width();if(400>n)var o=180,i=180,a=d3.geo.orthographic().scale(90).translate([o/2,i/2]).clipAngle(90).precision(.1);else var o=360,i=360,a=d3.geo.orthographic().scale(180).translate([o/2,i/2]).clipAngle(90).precision(.1);var r=d3.geo.path().projection(a),l=(d3.geo.graticule(),d3.select("#globe").append("svg").attr("width",o).attr("height",i)),s=l.append("g").attr("zoom",!1);s.append("defs").append("path").datum({type:"Sphere"}).attr("id","sphere").attr("d",r),s.append("use").attr("class","fill").attr("xlink:href","#sphere"),queue().defer(d3.json,"/lib/d3/world-110m.json").defer(d3.tsv,"/lib/d3/world-country-names.tsv").defer(d3.csv,"/lib/d3/locations.csv").await(e)}(),function(){var t=[{times:[{starting_time:757287682200,display:"circle",id:"born",index:31,location:"wz",tip:"Born in Wz,CN on 11/30/1993"}]},{times:[{starting_time:969655282200,display:"circle",id:"us",index:164,location:"nyc",tip:"Arrived in Nyc,US on 8/22/2000"}]},{times:[{starting_time:1224016882200,display:"circle",id:"hs",index:164,location:"nyc",tip:"Started Bronx Science HS on 9/14/2008"}]},{times:[{starting_time:1348260082200,display:"circle",id:"college",index:164,location:"sb",tip:"Started Stony Brook on 8/21/2012"}]},{times:[{starting_time:1435178482200,display:"circle",id:"bluum",index:164,location:"nyc",tip:"Intern at Bluum on 5/24/2015 to 8/12/2015"}]},{times:[{starting_time:1453585282200,display:"circle",id:"grad",index:164,location:"sb",tip:"Graduated Stony Brook on 12/23/2015"}]},{times:[{starting_time:1458679282200,display:"circle",id:"fxcm",index:164,location:"nyc",tip:"Started Fxcm on 2/22/2016"}]}],e=(d3.select("#tooltip"),d3.timeline().tickFormat({format:d3.time.format("%Y"),tickTime:d3.time.years,tickInterval:1,tickSize:3}).width("1000").beginning(757287682200).ending(1458679282200).mouseover(function(t,e,n){zoomOut(t.index,t.location,t.tip)}).mouseout(function(t,e,n){}));d3.select("#timeline").append("svg").attr("width","1000").datum(t).call(e)}()}]),app.controller("flappypigController",["$scope","$window","$document",function(t,e,n){new FlappyPig.Game}]),app.controller("googlemapController",["$scope",function(t){function e(){return"<div>Latitude:"+t.latitude+"</div><div>Longitude: "+t.longitude+"</div>"}t.latitude=40.764869,t.longitude=-73.972769;var n={lat:t.latitude,lng:t.longitude},o={center:n,zoom:10,mapTypeId:google.maps.MapTypeId.TERRAIN,disableDoubleClickZoom:!0},i=new google.maps.Map($("#map")[0],o),a=new google.maps.Marker({position:n,animation:google.maps.Animation.DROP,map:i,title:"Current Position",draggable:!0}),r=new google.maps.InfoWindow({content:e()});a.addListener("click",function(){r.open(i,a)}),a.addListener("drag",function(){t.latitude=a.getPosition().lat(),t.longitude=a.getPosition().lng(),r.setContent(e()),t.$apply()}),i.addListener("click",function(n){var o=n.latLng.lat(),i=n.latLng.lng();t.latitude=o,t.longitude=i,a.setPosition({lat:o,lng:i}),r.setContent(e()),t.$apply()}),t.positionChanged=function(){var e=parseFloat(t.latitude),n=parseFloat(t.longitude);e&&n&&i.setCenter({lat:e,lng:n})}}]),app.controller("infoController",["$scope","$interval",function(t,e){!function(){function n(t){for(var e=0;e<t.length;e++){var n=(new Date).getTime(),o=t[e],i=(o.timestamp||n)-n,a=r-o.size,s=l-o.size;o.timestamp=n,o.x+=i*o.velX,o.y+=i*o.velY,o.x>a?(o.x=a,o.velX*=-1):o.x<0&&(o.x=0,o.velX*=-1),o.y>s?(o.y=s,o.velY*=-1):o.y<0&&(o.y=0,o.velY*=-1)}}function o(t){for(var e=0;e<t.length;e++){var n=t[e];n.detectCollision(t)}}function i(e){for(var n=0;e>n;n++)t.bubbles.push(a(n))}function a(t){var e=.1,n=22,o=r-n,i=l-n;return{id:t,size:n,color:"white",x:Math.random()*o,y:Math.random()*i,maxVelocity:e,velX:Math.random()*e*(Math.random()<.5?-1:1),velY:Math.random()*e*(Math.random()<.5?-1:1),detectCollision:function(t){for(var e=0;e<t.length;e++){var n=t[e];if(n!=this){var o=n.x-this.x,i=n.y-this.y,a=Math.sqrt(o*o+i*i),r=n.size/2+this.size/2;if(r>a){for(;r>a;)n.x+=n.velX,n.y+=n.velY,this.x+=this.velX,this.y+=this.velY,o=n.x-this.x,i=n.y-this.y,a=Math.sqrt(o*o+i*i);this.velX*=-1,this.velY*=-1,n.velX*=-1,n.velY*=-1}}}}}}var r=jQuery(document).outerWidth(),l=jQuery(document).outerHeight(),s=r*l;if(75e4>s)var c=10;else var c=22;var d;t.$watch(function(){return jQuery(document).outerHeight()},function(e){l=e,t.bubbles=[],i(c)}),t.$watch(function(){return jQuery(document).outerWidth()},function(e){r=e,t.bubbles=[],i(c)}),t.bubbles=[],i(c),d=e(function(){n(t.bubbles),o(t.bubbles)},30)}(),function(){function e(e,n,l,c){if(e)throw e;var d=topojson.feature(n,n.objects.countries).features;d=d.filter(function(t){return l.some(function(e){return t.id==e.id?t.name=e.name:void 0})}).sort(function(t,e){return t.name.localeCompare(e.name)}),s.selectAll("path.land").data(d).enter().append("path").attr("class","land").attr("d",r).attr("name",function(t,e){return name=t.name}).attr("i",function(t,e){return e=e}),s.insert("path").datum(topojson.mesh(n,n.objects.countries,function(t,e){return t!==e})).attr("class","boundary").attr("d",r);var u,p=!1;s.selectAll("circle").data(c).enter().append("circle").attr("cx",function(t){return a([t.lon,t.lat])[0]}).attr("cy",function(t){return a([t.lon,t.lat])[1]}).attr("id",function(t){return t.location}).style("fill","#E43131").style("display","none");var m=d3.select("#tooltip");this.zoomIn=function(t,e){var n=r.bounds(d[t]),a=n[1][0]-n[0][0],l=n[1][1]-n[0][1],c=(n[0][0]+n[1][0])/2,f=(n[0][1]+n[1][1])/2,g=.9/Math.max(a/o,l/i),h=[o/2-g*c,i/2-g*f];s.transition().duration(750).attr("transform","translate("+h+")scale("+g+")").each("end",function(){s.attr("zoom",!0),u=d[t].name,p=!1;var n="#"+e;s.select(n).style("display","inline");var o=$(n).offset().left-100,i=$(n).offset().top-100;m.style("left",o+"px").style("top",i+"px").style("display","block")})},this.transition=function(t,e){d3.transition().duration(1e3).tween("rotate",function(){var e=d3.geo.centroid(d[t]),n=d3.interpolate(a.rotate(),[-e[0],-e[1]]);return function(t){a.rotate(n(t)),s.selectAll("path").attr("d",r).classed("focused",function(t,e){}),s.selectAll("circle").attr("cx",function(t){return a([t.lon,t.lat])[0]}).attr("cy",function(t){return a([t.lon,t.lat])[1]})}}).transition().each("end",function(){zoomIn(t,e)})},this.zoomOut=function(e,n,o){t.tip=o,t.$apply(),p||("true"===s.attr("zoom")&&u!=d[e].name?(m.style("display","none"),p=!0,s.transition().duration(750).attr("transform","translate(0,0) scale(1,1)").each("end",function(){s.selectAll("circle").style("display","none"),transition(e,n)})):"false"===s.attr("zoom")?(p=!0,s.selectAll("circle").style("display","none"),transition(e,n)):(s.selectAll("circle").style("display","none"),s.select("#"+n).style("display","inline")))}}var n=$(window).width();if(400>n)var o=180,i=180,a=d3.geo.orthographic().scale(90).translate([o/2,i/2]).clipAngle(90).precision(.1);else var o=360,i=360,a=d3.geo.orthographic().scale(180).translate([o/2,i/2]).clipAngle(90).precision(.1);var r=d3.geo.path().projection(a),l=(d3.geo.graticule(),d3.select("#globe").append("svg").attr("width",o).attr("height",i)),s=l.append("g").attr("zoom",!1);s.append("defs").append("path").datum({type:"Sphere"}).attr("id","sphere").attr("d",r),s.append("use").attr("class","fill").attr("xlink:href","#sphere"),queue().defer(d3.json,"/lib/d3/world-110m.json").defer(d3.tsv,"/lib/d3/world-country-names.tsv").defer(d3.csv,"/lib/d3/locations.csv").await(e)}(),function(){var t=[{times:[{starting_time:757287682200,display:"circle",id:"born",index:31,location:"wz",tip:"Born in Wz,CN on 11/30/1993"}]},{times:[{starting_time:969655282200,display:"circle",id:"us",index:164,location:"nyc",tip:"Arrived in Nyc,US on 8/22/2000"}]},{times:[{starting_time:1224016882200,display:"circle",id:"hs",index:164,location:"nyc",tip:"Started Bronx Science HS on 9/14/2008"}]},{times:[{starting_time:1348260082200,display:"circle",id:"college",index:164,location:"sb",tip:"Started Stony Brook on 8/21/2012"}]},{times:[{starting_time:1435178482200,display:"circle",id:"bluum",index:164,location:"nyc",tip:"Intern at Bluum on 5/24/2015 to 8/12/2015"}]},{times:[{starting_time:1453585282200,display:"circle",id:"grad",index:164,location:"sb",tip:"Graduated Stony Brook on 12/23/2015"}]},{times:[{starting_time:1458679282200,display:"circle",id:"fxcm",index:164,location:"nyc",tip:"Started Fxcm on 2/22/2016"}]}],e=(d3.select("#tooltip"),d3.timeline().tickFormat({format:d3.time.format("%Y"),tickTime:d3.time.years,tickInterval:1,tickSize:3}).width("1000").beginning(757287682200).ending(1458679282200).mouseover(function(t,e,n){zoomOut(t.index,t.location,t.tip)}).mouseout(function(t,e,n){}));d3.select("#timeline").append("svg").attr("width","1000").datum(t).call(e)}()}]),app.controller("nikeController",["$scope","$window","$http",function(t,e,n){function o(n){$.ajax({url:n,dataType:"JSONP",jsonpCallback:"callback",type:"GET",success:function(n){if(n.nextPageDataService&&10>c)s=n.nextPageDataService,r=r.concat(n.sections[0].products),o(s),c++;else{for(var d=0;d<r.length;d++){var u=r[d];u.newPrice=parseInt(u.localPrice.replace("$","")),u.oldPrice=parseInt(u.overriddenLocalPrice.replace("$",""));for(var p=!1,m=0;m<i.length;m++){var f=i[m];u.title==f.title&&(p=!0)}p||l.push(u)}l.length>0?(e.localStorage.setItem("prevNewShoes",JSON.stringify(l)),e.localStorage.setItem("oldShoes",JSON.stringify(r))):l=a,t.oldShoes=i,t.newShoes=l,t.currentShoes=r,t.showCurrent=!0,t.showNew=!1,t.$apply()}}})}var i=e.localStorage.getItem("oldShoes"),a=e.localStorage.getItem("prevNewShoes"),r=[],l=[],s="http://store.nike.com/html-services/gridwallData?country=US&lang_locale=en_US&gridwallPath=mens-clearance-shoes/47Z7puZoi3&sortOrder=publishdate|desc",c=0;i=i?JSON.parse(i):[],a=a?JSON.parse(a):[],o(s),t.toggleShoes=function(){t.showCurrent?(t.showCurrent=!1,t.showNew=!0):(t.showNew=!1,t.showCurrent=!0)}}]),app.controller("socketController",["$scope","$timeout","$http",function(t,e,n){var o=io.connect("localhost:3000"),i=$("#input-box");$("#message-box");i.on("keydown",function(t){return 13!=t.keyCode||t.shiftKey?void 0:(o.emit("message",i.val()),i.val(""),!1)}),o.on("message",function(e){t.messages.push(e),t.$apply()})}]),app.controller("whereamiController",["$scope",function(t){function e(){return"<div>Latitude:"+t.latitude+"</div><div>Longitude: "+t.longitude+"</div>"}t.latitude=0,t.longitude=0;var n=(new FileReader,{lat:t.latitude,lng:t.longitude}),o=new google.maps.Map($("#map")[0],{center:n,zoom:1,mapTypeId:google.maps.MapTypeId.TERRAIN,disableDoubleClickZoom:!0}),i=new google.maps.Marker({position:n,animation:google.maps.Animation.DROP,map:o,title:"Current Position",draggable:!1}),a=new google.maps.InfoWindow({content:e()});a.open(o,i),o.addListener("click",function(n){var o=n.latLng.lat(),r=n.latLng.lng();t.latitude=o,t.longitude=r,i.setPosition({lat:o,lng:r}),a.setContent(e()),t.$apply()})}]),app.controller("loginController",["$scope","$state","authentication",function(t,e,n){t.credentials={email:"",password:""},t.onSubmit=function(){n.login(t.credentials).error(function(t){console.log(t)}).then(function(){e.go("profile")})}}]),app.controller("profileController",["$scope","authentication",function(t,e){e.getProfile().success(function(e){t.user=e}).error(function(t){console.log(err)})}]),app.controller("registerController",["$scope","$state","authentication",function(t,e,n){t.credentials={email:"",password:""},t.onSubmit=function(){n.register(t.credentials).error(function(t){console.log(t)}).then(function(t){e.go("profile")})}}]),app.service("authentication",["$http","$window","user",function(t,e,n){this.saveToken=function(t){n.token=t},this.getToken=function(){return n.token},this.isLoggedIn=function(){var t,n=this.getToken();return n?(t=n.split(".")[1],t=e.atob(t),t=JSON.parse(t),t.exp>Date.now()/1e3):!1},this.currentUser=function(){if(isLoggedIn()){var t=getToken(),n=t.split(".")[1];return n=e.atob(n),n=JSON.parse(n),{email:n.email,name:n.name}}},this.register=function(e){var n=this;return t.post("/api/register",e).success(function(t){n.saveToken(t.token)})},this.login=function(e){var n=this;return t.post("/api/login",e).success(function(t){n.saveToken(t.token)})},this.logout=function(){n.token=void 0},this.getProfile=function(){var e=this;return t.get("/api/profile",{headers:{Authorization:"Bearer "+e.getToken()}})}}]),app.service("user",["$http",function(t){this.token,this.email,this.password}]);